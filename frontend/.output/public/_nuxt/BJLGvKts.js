import{c as a,d as y,_ as b}from"./CKdEhTHU.js";import{H as g,x as k,r as o,k as v,D as q,c as E,b as m,w as c,B as t,o as A,a as B,V as N,d as S,I as V}from"./Bh59aRpc.js";import{u as D}from"./DHrnonhk.js";import"./jyi1f3K3.js";import"./B4cRk-tp.js";import"./DNJGKzx0.js";import"./B9i1-_oj.js";import"./cefNi3wq.js";import"./BvlIk6eM.js";/* empty css        */import"./a5OFAv6S.js";const $={class:"max-w-md mx-auto mt-8"},R={class:"text-center mt-4"},J={__name:"register",setup(z){const d=g(),u=k(),{showNotification:p}=V(),r=o(!1),i=o(""),l=o({}),{handleApiErrors:f,resetErrors:h}=D({error:i,fieldErrors:l}),_=o({username:"",email:"",password:"",password_confirm:""}),x=[{key:"username",label:"Имя пользователя",type:"text",required:!0,cols:12,sm:12,md:12,prepend:"mdi-account",validation:a().required("Имя пользователя обязательно").min(3,"Минимум 3 символа").max(150,"Максимум 150 символов")},{key:"email",label:"Email",type:"text",required:!0,cols:12,sm:12,md:12,prepend:"mdi-email",validation:a().required("Email обязателен").email("Введите корректный email")},{key:"password",label:"Пароль",type:"password",required:!0,cols:12,sm:12,md:12,prepend:"mdi-lock",validation:a().required("Пароль обязателен").min(8,"Минимум 8 символов").matches(/[a-z]/,"Должен содержать строчные буквы").matches(/[A-Z]/,"Должен содержать заглавные буквы").matches(/[0-9]/,"Должен содержать цифры")},{key:"password_confirm",label:"Подтверждение пароля",type:"password",required:!0,cols:12,sm:12,md:12,prepend:"mdi-lock-check",validation:a().required("Подтверждение пароля обязательно").oneOf([y("password")],"Пароли должны совпадать")}],w=async n=>{var e;r.value=!0,h();try{await u.postWithString("accounts/register/",n),p({message:"Регистрация успешно завершена! Теперь вы можете войти в систему.",type:"success"}),d.push("/login")}catch(s){(e=s.response)!=null&&e.data?f(s.response.data):i.value="Произошла ошибка при регистрации. Попробуйте позже."}finally{r.value=!1}};return v(()=>{q().isAuthenticated&&d.push("/dashboard")}),(n,e)=>{const s=b;return A(),E("div",$,[m(s,{title:"Регистрация",fields:x,"initial-data":t(_),loading:t(r),error:t(i),"field-errors":t(l),"submit-button-text":t(r)?"Регистрация...":"Зарегистрироваться","show-cancel":!1,"show-reset":!1,onSubmit:w},{"additional-fields":c(()=>[B("div",R,[m(N,{variant:"text",color:"primary",to:"/login",class:"text-none"},{default:c(()=>e[0]||(e[0]=[S(" Уже есть аккаунт? Войти ")])),_:1})])]),_:1},8,["initial-data","loading","error","field-errors","submit-button-text"])])}}};export{J as default};
